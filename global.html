<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Global - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Body.html">Body</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Body.html#parseJSON">parseJSON</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Body.html#parseText">parseText</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Body.html#parseURLSearchParams">parseURLSearchParams</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="CompletedContext.html">CompletedContext</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="HTTPClient.html">HTTPClient</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="HTTPClient.html#.delete">delete</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="HTTPClient.html#.get">get</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="HTTPClient.html#.post">post</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="HTTPClient.html#.put">put</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="HTTPClient.html#.request">request</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="HTTPClient.html#.update">update</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Headers.html">Headers</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Headers.html#append">append</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Headers.html#delete">delete</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Headers.html#encode">encode</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Headers.html#entries">entries</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Headers.html#forEach">forEach</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Headers.html#get">get</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Headers.html#has">has</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Headers.html#keys">keys</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Headers.html#set">set</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Headers.html#values">values</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Request.html">Request</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Response.html">Response</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="RewriteContext.html">RewriteContext</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="ScheduleContext.html">ScheduleContext</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="SharedPreferences.html">SharedPreferences</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="SharedPreferences.html#.read">read</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="SharedPreferences.html#.write">write</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="URLSearchParams.html">URLSearchParams</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="URLSearchParams.html#append">append</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="URLSearchParams.html#delete">delete</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="URLSearchParams.html#entries">entries</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="URLSearchParams.html#forEach">forEach</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="URLSearchParams.html#get">get</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="URLSearchParams.html#has">has</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="URLSearchParams.html#keys">keys</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="URLSearchParams.html#set">set</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="URLSearchParams.html#sort">sort</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="URLSearchParams.html#toString">toString</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="URLSearchParams.html#values">values</a></span></li><li class="nav-heading"><a href="global.html">Globals</a></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#onRequest">onRequest</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#onResponse">onResponse</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#onSchedule">onSchedule</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#onSessionCompleted">onSessionCompleted</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">Global</h1>
    

    




<section>

<header>
    
        <h2>
        
        </h2>
        
    
</header>

<article>
    <div class="container-overview">
    
        

        


<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>


        
    
    </div>

    

    

    

     

    

    

    
        <h3 class="subsection-title">Methods</h3>

        
            
<div class="section-method">

    

    <h4 class="name" id="onRequest"><span class="type-signature">(async) </span>onRequest<span class="signature">(context, url, request)</span><span class="type-signature"> &rarr; {Promise.&lt;void>}</span></h4>

    



<div class="description">
    This function is called before the HTTP request is sent to the server.
You can use this method to modify the HTTP request data.
If you do not modify the request, you should delete this function to avoid unnecessary calls.
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>context</code></td>
            

            <td class="type">
            
                
<span class="param-type"><code><a href="RewriteContext.html">RewriteContext</a></code></span>


            
            </td>

            

            

            <td class="description last">
                The context object.
                
            </td>
        </tr>

    

        <tr>
            
                <td class="name"><code>url</code></td>
            

            <td class="type">
            
                
<span class="param-type"><code>string</code></span>


            
            </td>

            

            

            <td class="description last">
                The URL of the HTTP request.
                
            </td>
        </tr>

    

        <tr>
            
                <td class="name"><code>request</code></td>
            

            <td class="type">
            
                
<span class="param-type"><code><a href="Request.html">Request</a></code></span>


            
            </td>

            

            

            <td class="description last">
                The HTTP request object.
                
            </td>
        </tr>

    
    </tbody>
</table>














<div class="section-returns">
<h5>Returns:</h5>

        

<dl class="param-type">
    <dt>
        Type:
    </dt>
    <dd>
        
<span class="param-type"><code>Promise.&lt;void></code></span>


    </dd>
</dl>


<div class="param-desc">
    - A promise that resolves when the function execution is completed.
</div>

    
</div>



<div class="section-examples">
<h5>Example</h5>

    <pre class="prettyprint"><code>async function onRequest(context, url, request) {
        console.log(url);
        // pass parameters to onResponse
        context.parameters["custom"] = "custom parameters"
        
        // redirect
        request.scheme = "https"
        request.path = "/upload/json"
        request.host = "www.google.com"
        request.port = 443
        
        // queries
        request.queries.append("appendname", "appendvalue")
        request.queries.set("replacename", "replacevalue")
        request.queries.get("name")
        request.queries.delete("name")
        request.queries.has("name")
        
        // headers has same function like queries
        request.headers.delete("accept")
        request.headers.append("headname", "headvalue")
        request.headers.forEach((value, name) => {
            console.log(`${name}: ${value}`);
        });

        // parse body to json object
        var json = request.body.parseJSON()
        json["script_json"] = "JSONValue"
        request.body = json
        // Done
        return request;
    }</code></pre>

</div>

</div>
        
            
<div class="section-method">

    

    <h4 class="name" id="onResponse"><span class="type-signature">(async) </span>onResponse<span class="signature">(context, url, response)</span><span class="type-signature"> &rarr; {Promise.&lt;void>}</span></h4>

    



<div class="description">
    This function is called before the HTTP response is sent to the client.
You can use this method to modify the HTTP response data.
If you do not modify the response, you should delete this function to avoid unnecessary calls.
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>context</code></td>
            

            <td class="type">
            
                
<span class="param-type"><code><a href="RewriteContext.html">RewriteContext</a></code></span>


            
            </td>

            

            

            <td class="description last">
                The context object.
                
            </td>
        </tr>

    

        <tr>
            
                <td class="name"><code>url</code></td>
            

            <td class="type">
            
                
<span class="param-type"><code>string</code></span>


            
            </td>

            

            

            <td class="description last">
                The URL of the HTTP response.
                
            </td>
        </tr>

    

        <tr>
            
                <td class="name"><code>response</code></td>
            

            <td class="type">
            
                
<span class="param-type"><code><a href="Response.html">Response</a></code></span>


            
            </td>

            

            

            <td class="description last">
                The HTTP response object.
                
            </td>
        </tr>

    
    </tbody>
</table>














<div class="section-returns">
<h5>Returns:</h5>

        

<dl class="param-type">
    <dt>
        Type:
    </dt>
    <dd>
        
<span class="param-type"><code>Promise.&lt;void></code></span>


    </dd>
</dl>


<div class="param-desc">
    - A promise that resolves when the function execution is completed.
</div>

    
</div>



<div class="section-examples">
<h5>Example</h5>

    <pre class="prettyprint"><code>async function onResponse(context, url, response) {
      console.log(`onResponse ${url}`);
      // get parameters from onRequest
      for (var prop in context.parameters) {
          console.log(prop + ': ' + context.parameters[prop]);
      }
      // body
      // URLSearchParams has same function like queries
      var urlencoded = response.body.parseURLSearchParams()
      urlencoded.append("script", "parseURLSearchParams")
      response.body = urlencoded
      // Done
      return response;
  }</code></pre>

</div>

</div>
        
            
<div class="section-method">

    

    <h4 class="name" id="onSchedule"><span class="type-signature">(async) </span>onSchedule<span class="signature">(context)</span><span class="type-signature"> &rarr; {Promise.&lt;void>}</span></h4>

    



<div class="description">
    This function will be called at the scheduled timer trigger time.
It is mainly used to perform some scheduled tasks.
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>context</code></td>
            

            <td class="type">
            
                
<span class="param-type"><code><a href="ScheduleContext.html">ScheduleContext</a></code></span>


            
            </td>

            

            

            <td class="description last">
                The context object.
                
            </td>
        </tr>

    
    </tbody>
</table>














<div class="section-returns">
<h5>Returns:</h5>

        

<dl class="param-type">
    <dt>
        Type:
    </dt>
    <dd>
        
<span class="param-type"><code>Promise.&lt;void></code></span>


    </dd>
</dl>


<div class="param-desc">
    - A promise that resolves when the function execution is completed.
</div>

    
</div>



<div class="section-examples">
<h5>Example</h5>

    <pre class="prettyprint"><code>async function onSchedule(context) {
      /// print custom parameters
      for (var prop in context.parameters) {
          console.log(`${prop}: ${context.parameters[prop]}`);
      }
      /// custom parameters
      context.parameters["custom"] = "custom parameters for next runloop";
      /// scriptName
      console.log(`scriptName ${context.scriptName}`);
      /// repeatedCount
      console.log(`repeatedCount ${context.repeatedCount}`);
      /// abort schedule
      if (context.repeatedCount == 2) {
          abort()
      }
  }</code></pre>

</div>

</div>
        
            
<div class="section-method">

    

    <h4 class="name" id="onSessionCompleted"><span class="type-signature">(async) </span>onSessionCompleted<span class="signature">(context, url, request, response)</span><span class="type-signature"> &rarr; {Promise.&lt;void>}</span></h4>

    



<div class="description">
    This function is called after the HTTP response is returned.
It can be used for HTTP data collection.
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>context</code></td>
            

            <td class="type">
            
                
<span class="param-type"><code><a href="CompletedContext.html">CompletedContext</a></code></span>


            
            </td>

            

            

            <td class="description last">
                The context object.
                
            </td>
        </tr>

    

        <tr>
            
                <td class="name"><code>url</code></td>
            

            <td class="type">
            
                
<span class="param-type"><code>string</code></span>


            
            </td>

            

            

            <td class="description last">
                The URL of the HTTP request.
                
            </td>
        </tr>

    

        <tr>
            
                <td class="name"><code>request</code></td>
            

            <td class="type">
            
                
<span class="param-type"><code><a href="Request.html">Request</a></code></span>


            
            </td>

            

            

            <td class="description last">
                The HTTP request object.
                
            </td>
        </tr>

    

        <tr>
            
                <td class="name"><code>response</code></td>
            

            <td class="type">
            
                
<span class="param-type"><code><a href="Response.html">Response</a></code></span>


            
            </td>

            

            

            <td class="description last">
                The HTTP response object.
                
            </td>
        </tr>

    
    </tbody>
</table>














<div class="section-returns">
<h5>Returns:</h5>

        

<dl class="param-type">
    <dt>
        Type:
    </dt>
    <dd>
        
<span class="param-type"><code>Promise.&lt;void></code></span>


    </dd>
</dl>


<div class="param-desc">
    - A promise that resolves when the function execution is completed.
</div>

    
</div>



<div class="section-examples">
<h5>Example</h5>

    <pre class="prettyprint"><code>// sample of pass data to local http server
async function onSessionCompleted(context, url, request, response) {
    try {
        var reqBody = request.body.parseText();
        var rspBody = response.body.parseText()
        var params = {
            "body" : {
                "url": url,
                "reqHeader": request.headers.encode(),
                "reqBody": reqBody,
                "rspHeader": response.headers.encode(),
                "rspBody": rspBody,
            },
            "headers": {"from": "onSessionCompleted"},
        }
        // send http session data to other server
        const rsp = await HTTPClient.post("http://192.168.3.30:8000/upload", params)
        let json = rsp.body.parseText()
    } catch(error) {
        console.log(error)
    }
}</code></pre>

</div>

</div>
        
    

    

    
</article>

</section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.2</a> on Tue Apr 23 2024 22:32:29 GMT+0800 (中国标准时间) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>